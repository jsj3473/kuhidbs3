
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>기업 정보 조회</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script>
        let companyId = /*[[${companyId}]]*/ '';
        // console.log("companyId:", companyId);
        document.addEventListener("DOMContentLoaded", function () {
            let companyId = /*[[${companyId}]]*/ '';
            // console.log("companyId:", companyId);
            if (companyId) {
                console.log("companyId: " + companyId);
                fetchCompanyInfo(companyId);
            }
        });

        function fetchCompanyInfo(companyId) {
            // fetch(`/api/companies/companyRead/${companyId}`)
            fetch(`/api/companies/info/${companyId}`)
                .then(response => response.json())
                .then(data => updateCompanyInfo(data))
                .catch(error => console.error("데이터 로드 실패:", error));
        }

        function updateCompanyInfo(data) {
            document.getElementById("companyId").value = data.companyId || "";
            document.getElementById("companyName").value = data.companyName || "";
            document.getElementById("establishmentDate").value = data.establishmentDate || "";
            document.getElementById("ceoName").value = data.ceoName || "";
            document.getElementById("companyAddress").value = data.companyAddress || "";
            document.getElementById("businessRegistrationNumber").value = data.businessRegistrationNumber || "";
            document.getElementById("corporateRegistrationNumber").value = data.corporateRegistrationNumber || "";
            document.getElementById("industryCode").value = data.industryCode || "";
            document.getElementById("capital").value = data.capital || "";
            document.getElementById("parValue").value = data.parValue || "";
            document.getElementById("employeeCount").value = data.employeeCount || "";

            document.getElementById("kuhSubsidiary").value = data.kuhSubsidiary || "";
            document.getElementById("kuhStartup").value = data.kuhStartup || "";
            document.getElementById("startupType").value = data.startupType || "";
            document.getElementById("earlyStartupType").value = data.earlyStartupType || "";
            document.getElementById("smeStatus").value = data.smeStatus || "";
            document.getElementById("regionalCompany").value = data.regionalCompany || "";
            document.getElementById("ventureRecognition").value = data.ventureRecognition || "";
            document.getElementById("researchRecognition").value = data.researchRecognition || "";
            document.getElementById("publicTechnologyTransfer").value = data.publicTechnologyTransfer || "";
            document.getElementById("dueDiligence").value = data.dueDiligence || "";
            document.getElementById("listingStatus").value = data.listingStatus || "";

            document.getElementById("investmentSector").value = data.investmentSector || "";
            document.getElementById("mainProducts").value = data.mainProducts || "";
            document.getElementById("investmentPoint1").value = data.investmentPoint1 || "";
            document.getElementById("investmentPoint2").value = data.investmentPoint2 || "";
            document.getElementById("investmentPoint3").value = data.investmentPoint3 || "";

            document.getElementById("manager1").value = data.manager1 || "";
            document.getElementById("manager2").value = data.manager2 || "";
            document.getElementById("manager3").value = data.manager3 || "";
            document.getElementById("positionType").value = data.positionType || "";
            document.getElementById("phoneNumber").value = data.phoneNumber || "";
            document.getElementById("email").value = data.email || "";
            document.getElementById("name").value = data.name || "";

            if (data.currentStatusDTO) {
                document.getElementById("status").value = data.currentStatusDTO.status || "";
            }

            if (data.rmngDTO) {
                document.getElementById("managementYear").value = data.rmngDTO.year || "";
                document.getElementById("evalGrade").value = data.rmngDTO.evalGrade || "";
                document.getElementById("businessProgress1").value = data.rmngDTO.businessProgress1 || "";
                document.getElementById("businessProgress2").value = data.rmngDTO.businessProgress2 || "";
            }

            updateFinancialsTable(data.recentFinancials);
            updateInvestmentTable(data.rivtDTO);
            updateShareholderTable(data.shrDTO);
        }

        //재무제표
        function updateFinancialsTable(financials) {
            const tableBody = document.getElementById("financialsTable");
            tableBody.innerHTML = "";

            financials.forEach(financial => {
                const row = `<tr>
            <td>${financial.financialYear || ""} (${financial.financialHalf === 1 ? "상반기" : "하반기"})</td>
            <td>${financial.revenue?.toLocaleString() || ""}</td>
            <td>${financial.operatingProfit?.toLocaleString() || ""}</td>
            <td>${financial.netIncome?.toLocaleString() || ""}</td>
            <td>${financial.totalAssets?.toLocaleString() || ""}</td>
            <td>${financial.totalDebt?.toLocaleString() || ""}</td>
            <td>${financial.totalCapital?.toLocaleString() || ""}</td>
            <td>${financial.capital?.toLocaleString() || ""}</td>
            <td>${financial.employeeCount?.toLocaleString() || ""}</td>
        </tr>`;
                tableBody.innerHTML += row;
            });
        }
        //투자정보
        function updateInvestmentTable(investmentData) {
            const tableBody = document.getElementById("investmentTable");
            tableBody.innerHTML = "";

            const row = `<tr>
            <td>${investmentData.investmentDate || ""}</td>
            <td>${investmentData.investmentProduct || ""}</td>
            <td>${investmentData.investmentAmount?.toLocaleString() || ""} 원</td>
            <td>${investmentData.investmentUnitPrice?.toLocaleString() || ""} 원</td>
            <td>${investmentData.shareCount?.toLocaleString() || ""} 주</td>
            <td>${investmentData.equityRate?.toFixed(2) || ""} %</td>
            <td>${investmentData.totalShares?.toLocaleString() || ""} 주</td>
            <td>${investmentData.investmentValue?.toLocaleString() || ""} 원</td>
            <td>${investmentData.currentCompanyValue?.toLocaleString() || ""} 원</td>
            <td>${investmentData.investmentStep || ""}</td>
        </tr>`;

            tableBody.innerHTML = row;
        }

        //주주명부
        function updateShareholderTable(shareholderData) {
            const tableBody = document.getElementById("shareholderTable");
            tableBody.innerHTML = "";

            // 주주명 데이터
            const nameRow = `<tr>
            <td>${shareholderData.shareholderName1 || ""}</td>
            <td>${shareholderData.shareholderName2 || ""}</td>
            <td>${shareholderData.shareholderName3 || ""}</td>
            <td>${shareholderData.shareholderName4 || ""}</td>
            <td>${shareholderData.shareholderName5 || ""}</td>
            <td>${shareholderData.shareholderName6 || ""}</td>
            <td>${shareholderData.shareholderName7 || ""}</td>
            <td>${shareholderData.shareholderName8 || ""}</td>
            <td class="align-middle">발행총주식수</td>
        </tr>`;

            // 주식수량 데이터
            const countRow = `<tr>
            <td>${shareholderData.shareholderCount1?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount2?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount3?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount4?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount5?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount6?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount7?.toLocaleString() || ""}</td>
            <td>${shareholderData.shareholderCount8?.toLocaleString() || ""}</td>
            <td>${shareholderData.totalShareCount?.toLocaleString() || ""}</td>
        </tr>`;

            // 지분율 데이터
            const rateRow = `<tr>
            <td>${shareholderData.shareholderRate1?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate2?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate3?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate4?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate5?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate6?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate7?.toFixed(2) || ""} %</td>
            <td>${shareholderData.shareholderRate8?.toFixed(2) || ""} %</td>
            <td>${shareholderData.totalEquityRate?.toFixed(2) || ""} %</td>
        </tr>`;

            tableBody.innerHTML = nameRow + countRow + rateRow;
        }


    </script>
</head>
<body class="container mt-4">
<input type="hidden" id="companyIdValue" th:value="${companyId}" />

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let companyId = document.getElementById("companyIdValue").value;
        console.log("✅ companyId:", companyId);
        if (companyId) {
            fetchCompanyInfo(companyId);
        }
    });
</script>
<h2 class="mb-4">기업 정보 조회</h2>

<!-- 1. 회사 기본 정보 -->
<div class="card mb-4">
    <div class="card-header">회사 기본 정보</div>
    <div class="card-body">
        <div class="mb-3"><label class="form-label">회사 고유번호</label><input type="text" class="form-control" id="companyId" readonly></div>
        <div class="mb-3"><label class="form-label">투자 상태</label><input type="text" class="form-control" id="status" readonly></div>
        <div class="mb-3"><label class="form-label">회사명</label><input type="text" class="form-control" id="companyName" readonly></div>
        <div class="mb-3"><label class="form-label">설립 일자</label><input type="text" class="form-control" id="establishmentDate" readonly></div>
        <div class="mb-3"><label class="form-label">대표 이사</label><input type="text" class="form-control" id="ceoName" readonly></div>
        <div class="mb-3"><label class="form-label">회사 주소</label><input type="text" class="form-control" id="companyAddress" readonly></div>
        <div class="mb-3"><label class="form-label">사업자 등록번호</label><input type="text" class="form-control" id="businessRegistrationNumber" readonly></div>
        <div class="mb-3"><label class="form-label">법인 등록번호</label><input type="text" class="form-control" id="corporateRegistrationNumber" readonly></div>
        <div class="mb-3"><label class="form-label">표준 산업분류</label><input type="text" class="form-control" id="industryCode" readonly></div>
        <div class="mb-3"><label class="form-label">자본금</label><input type="text" class="form-control" id="capital" readonly></div>
        <div class="mb-3"><label class="form-label">액면가</label><input type="text" class="form-control" id="parValue" readonly></div>
        <div class="mb-3"><label class="form-label">임직원 수</label><input type="text" class="form-control" id="employeeCount" readonly></div>
    </div>
</div>

<!-- 2. 회사 속성 정보 -->
<!-- 2. 회사 속성 정보 -->
<div class="card mb-4">
    <div class="card-header">회사 속성 정보</div>
    <div class="card-body">
        <div class="mb-3">
            <label class="form-label">KUH 자회사</label>
            <select readonly class="form-control" id="kuhSubsidiary">
                <option value="">선택하세요</option>
                <option value="KUH자회사">KUH자회사</option>
                <option value="일반기업">일반기업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">고대창업구분</label>
            <select readonly class="form-control" id="kuhStartup">
                <option value="">선택하세요</option>
                <option value="고려대창업">고려대창업</option>
                <option value="비고려대창업">비고려대창업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">창업구분</label>
            <select readonly class="form-control" id="startupType">
                <option value="">선택하세요</option>
                <option value="교원창업">교원창업</option>
                <option value="학생창업">학생창업</option>
                <option value="일반창업">일반창업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">초기창업구분</label>
            <select readonly class="form-control" id="earlyStartupType">
                <option value="">선택하세요</option>
                <option value="창업 3년 이내">창업 3년 이내</option>
                <option value="창업 7년 이내">창업 7년 이내</option>
                <option value="창업 7년 초과">창업 7년 초과</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">중소기업구분</label>
            <select readonly class="form-control" id="smeStatus">
                <option value="">선택하세요</option>
                <option value="중소기업">중소기업</option>
                <option value="대기업">대기업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">지방창업구분</label>
            <select readonly class="form-control" id="regionalCompany">
                <option value="">선택하세요</option>
                <option value="서울창업">서울창업</option>
                <option value="지방창업">지방창업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">벤처기업구분</label>
            <select readonly class="form-control" id="ventureRecognition">
                <option value="">선택하세요</option>
                <option value="벤처기업">벤처기업</option>
                <option value="일반기업">일반기업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">연구소기업구분</label>
            <select readonly class="form-control" id="researchRecognition">
                <option value="">선택하세요</option>
                <option value="연구소기업">연구소기업</option>
                <option value="일반기업">일반기업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">공공기술이전</label>
            <select readonly class="form-control" id="publicTechnologyTransfer">
                <option value="">선택하세요</option>
                <option value="기술이전기업">기술이전기업</option>
                <option value="일반기업">일반기업</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">투자기업실사</label>
            <select readonly class="form-control" id="dueDiligence">
                <option value="">선택하세요</option>
                <option value="미실사기업">미실사기업</option>
                <option value="실사기업">실사기업</option>
                <option value="실사보완중">실사보완중</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">상장여부</label>
            <select readonly class="form-control" id="listingStatus">
                <option value="">선택하세요</option>
                <option value="비상장기업">비상장기업</option>
                <option value="상장기업">상장기업</option>
                <option value="상장완료">상장완료</option>
            </select>
        </div>
    </div>
</div>


<!-- 3. BIZ SECTOR 및 투자 Highlight -->
<div class="card mb-4">
    <div class="card-header">BIZ SECTOR 구분</div>
    <div class="card-body">
        <div class="mb-3"><label class="form-label">BIZ SECTOR</label><input type="text" class="form-control" id="investmentSector" readonly></div>
        <div class="mb-3"><label class="form-label">주요 제품 내용</label><textarea class="form-control" id="mainProducts" rows="2" readonly></textarea></div>
    </div>
    <div class="card-header">투자 Highlight (포인트)</div>
    <div class="card-body">
        <div class="mb-3"><label class="form-label">포인트 1</label><textarea class="form-control" id="investmentPoint1" rows="2" readonly></textarea></div>
        <div class="mb-3"><label class="form-label">포인트 2</label><textarea class="form-control" id="investmentPoint2" rows="2" readonly></textarea></div>
        <div class="mb-3"><label class="form-label">포인트 3</label><textarea class="form-control" id="investmentPoint3" rows="2" readonly></textarea></div>
    </div>
</div>

<!-- 4. 요약 재무제표 -->
<div class="card mb-4">
    <div class="card-header">요약 재무제표 (최근 2회차)</div>
    <div class="card-body">
        <table class="table table-bordered text-center">
            <thead>
            <tr>
                <th>연도(반기)</th>
                <th>매출액</th>
                <th>영업이익</th>
                <th>당기순익</th>
                <th>자산총계</th>
                <th>부채총계</th>
                <th>자본총계</th>
                <th>자본금</th>
                <th>임직원수</th>
            </tr>
            </thead>
            <tbody id="financialsTable"></tbody>
        </table>
    </div>
</div>
<!-- KUH 투자내역 카드 -->
<div class="card mb-4">
    <div class="card-header">KUH 투자내역</div>
    <div class="card-body">
        <table class="table table-bordered text-center">
            <thead>
            <tr>
                <th>투자일자</th>
                <th>투자상품</th>
                <th>투자금액</th>
                <th>투자단가</th>
                <th>주식수량</th>
                <th>지분율</th>
                <th>발행주식</th>
                <th>투자밸류</th>
                <th>현재밸류</th>
                <th>투자단계</th>
            </tr>
            </thead>
            <tbody id="investmentTable"></tbody>
        </table>
    </div>
</div>
<!-- 주주명부 카드 -->
<div class="card mb-4">
    <div class="card-header">주주명부</div>
    <div class="card-body">
        <table class="table table-bordered text-center">
            <thead>
            <tr>
                <th>주주명 1</th>
                <th>주주명 2</th>
                <th>주주명 3</th>
                <th>주주명 4</th>
                <th>주주명 5</th>
                <th>주주명 6</th>
                <th>주주명 7</th>
                <th>주주명 8</th>
                <th>발행총주식수</th>
            </tr>
            </thead>
            <tbody id="shareholderTable"></tbody>
        </table>
    </div>
</div>
<!-- 투자 담당자 정보 -->
<div class="card mb-4">
    <div class="card-header">투자 담당자 및 기업 실무자 정보</div>
    <div class="card-body">
        <div class="mb-3"><label class="form-label">투자 발굴자</label><input type="text" class="form-control" id="manager1" readonly></div>
        <div class="mb-3"><label class="form-label">투자 심사자</label><input type="text" class="form-control" id="manager2" readonly></div>
        <div class="mb-3"><label class="form-label">사후 관리 담당자</label><input type="text" class="form-control" id="manager3" readonly></div>
        <div class="mb-3"><label class="form-label">기업 담당자명/직책</label>
            <input type="text" class="form-control" id="name" readonly>
            <input type="text" class="form-control" id="positionType" readonly>
        </div>
        <div class="mb-3"><label class="form-label">전화번호</label><input type="text" class="form-control" id="phoneNumber" readonly></div>
        <div class="mb-3"><label class="form-label">이메일</label><input type="email" class="form-control" id="email" readonly></div>
    </div>
</div>

<!-- 사후관리 정보 -->
<div class="card mb-4">
    <div class="card-header">사후관리 정보</div>
    <div class="card-body">
        <div class="mb-3"><label class="form-label">관리 연도</label><input type="text" class="form-control" id="managementYear" readonly></div>
        <div class="mb-3"><label class="form-label">관리 등급</label><input type="text" class="form-control" id="evalGrade" readonly></div>
        <div class="mb-3"><label class="form-label">사업 진행 현황 1</label><input type="text" class="form-control" id="businessProgress1" readonly></div>
        <div class="mb-3"><label class="form-label">사업 진행 현황 2</label><input type="text" class="form-control" id="businessProgress2" readonly></div>
    </div>
</div>


</body>
</html>
