<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KUH IDBS 네비게이션</title>

    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <script defer th:src="@{/js/bootstrap.bundle.min.js}"></script>
    <link rel="stylesheet" th:href="@{/css/datatables-custom.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/sidebar.css}">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">


    <style>
        .navbar {
            background-color: #f8f9fa;
        }
        .logo-img {
            height: 40px;
        }
        .emp-img {
            height: 32px;
            width: 32px;
            border-radius: 50%;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const searchModal = new bootstrap.Modal(document.getElementById('searchModal'));
            const searchInput = document.getElementById('companyIdInput');
            const searchButton = document.getElementById('searchButton');

            function openSearchModal(target) {
                searchInput.value = ''; // 입력창 초기화
                searchButton.setAttribute("onclick", `goToPage('${target}')`);
                searchModal.show();
                setTimeout(() => searchInput.focus(), 200); // 모달 열리면 자동 포커스
            }

            function goToPage(target) {
                const companyId = searchInput.value.trim();
                if (!companyId) {
                    alert("회사 고유번호를 입력하세요.");
                    return;
                }
                window.location.href = `/${target}/${companyId}`;
            }

            // Enter 키 입력 시 검색 실행
            searchInput.addEventListener("keypress", function (event) {
                if (event.key === "Enter") {
                    searchButton.click();
                }
            });

            // 검색 버튼 클릭 시 실행 (중복 이벤트 방지)
            searchButton.addEventListener("click", function () {
                goToPage(searchButton.getAttribute("onclick").match(/'([^']+)'/)[1]);
            });

            // 전역 함수로 설정 (Thymeleaf에서 호출 가능)
            window.openSearchModal = openSearchModal;
        });

    </script>

</head>
<body>

<!-- 네비게이션 바 -->
<nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-fluid d-flex align-items-center">

        <!-- 좌측 로고 -->
        <div class="sidebar-logo">
            <img src="/images/KuLogo2.gif" alt="프로그램 로고" class="logo-img">
            <h1 class="logo-text">KUH IDBS</h1>
        </div>

        <!-- 네비게이션 메뉴 (왼쪽 정렬) -->
        <ul class="navbar-nav me-auto">
            <li class="nav-item">
                <a class="nav-link" href="#">대시보드</a>
            </li>

            <!-- 투자관리 Dropdown -->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#"
                   id="investDropdown" role="button"
                   data-bs-toggle="dropdown" aria-expanded="false">
                    투자관리
                </a>
                <ul class="dropdown-menu" aria-labelledby="investDropdown">
                    <li><a class="dropdown-item" href="#" onclick="openSearchModal('companyShow')">기업정보조회</a></li>
                    <li><a class="dropdown-item" href="/companyAdd">신규기업등록</a></li>
                    <li><a class="dropdown-item" href="#" onclick="openSearchModal('companyManage')">투자후속관리</a></li>
                </ul>
            </li>

            <!-- 조합관리 Dropdown -->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#"
                   id="fundDropdown" role="button"
                   data-bs-toggle="dropdown" aria-expanded="false">
                    조합관리
                </a>
                <ul class="dropdown-menu" aria-labelledby="fundDropdown">
                    <li><a class="dropdown-item" href="#">조합정보조회</a></li>
                    <li><a class="dropdown-item" href="#">신규조합등록</a></li>
                </ul>
            </li>

            <!-- 시스템관리 Dropdown -->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#"
                   id="systemDropdown" role="button"
                   data-bs-toggle="dropdown" aria-expanded="false">
                    시스템관리
                </a>
                <ul class="dropdown-menu" aria-labelledby="systemDropdown">
                    <li><a class="dropdown-item" href="#">사용자관리</a></li>
                    <li><a class="dropdown-item" href="#">권한설정</a></li>
                    <li><a class="dropdown-item" href="#">로그조회</a></li>
                </ul>
            </li>
        </ul>

        <!-- 우측 사용자 정보 및 로그아웃 버튼 -->
        <div class="d-flex align-items-center">
            <div class="employee-info me-3">
                <span th:text="${empId} + ' ' + ${empName}"></span>
            </div>
            <img src="/images/EmpImg.png" alt="사원 사진" class="emp-img me-3">
            <button class="btn btn-outline-dark btn-sm" id="logoutButton" onclick="confirmLogout()">로그아웃</button>
        </div>

    </div>
</nav>

<!-- 🔍 검색 모달 -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body p-2 d-flex align-items-center">
                <input type="text" id="companyIdInput" class="form-control me-2" placeholder="고유번호 입력" style="flex: 1; min-width: 120px;">
                <button type="button" class="btn btn-primary btn-sm" id="searchButton">검색</button>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
        </div>
    </div>
</div>



</body>
</html>
