<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>조합원 구성</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <script defer th:src="@{/js/bootstrap.bundle.min.js}"></script>
    <link rel="stylesheet" th:href="@{/css/slimTable.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

</head>
<body class="container mt-4">

<h2 class="mb-4">조합원 구성</h2>

<!-- 조합 ID 정보 -->
<!--<p style="display: none;"><strong>조합 ID:</strong> <span th:text="${fundId}"></span></p>-->

<!-- ✅ 조합원 테이블 -->
<table class="table table-bordered text-center">
    <thead>
    <tr>
        <th rowspan="2">No</th>
        <th rowspan="2">조합원명</th>
        <th colspan="2">출자약정액</th>
        <th rowspan="2">조합원유형</th>
    </tr>
    <tr>
        <th>금액</th>
        <th>비율</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="member : ${rFundMemDTOS}">
        <td th:text="${member.memberName}"></td>
        <td th:text="${#numbers.formatInteger(member.committedUnitPrice, 3, 'COMMA')} + ' 원'"></td>
        <td th:text="${#numbers.formatDecimal(member.contributionRate, 1, 2, 'POINT')} + ' %'"></td>
        <td th:text="${member.memberType}"></td>
    </tr>
    </tbody>
    <tfoot>
    <tr>
        <th colspan="2">합계</th>
        <td id="totalCommittedUnitPrice">0</td>
        <td id="totalContributionRate">0 %</td>
        <th></th>
    </tr>
    </tfoot>
</table>

</body>
</html>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        let totalPrice = 0;
        let totalRate = 0;

        document.querySelectorAll(".committedUnitPrice").forEach(td => {
            let value = parseInt(td.innerText.replace(/[^0-9]/g, "")) || 0;
            totalPrice += value;
        });

        document.querySelectorAll(".contributionRate").forEach(td => {
            let value = parseFloat(td.innerText.replace(/[^0-9.]/g, "")) || 0;
            totalRate += value;
        });

        document.getElementById("totalCommittedUnitPrice").innerText = totalPrice.toLocaleString() + " 원";
        document.getElementById("totalContributionRate").innerText = totalRate.toFixed(2) + " %";
    });
</script>
